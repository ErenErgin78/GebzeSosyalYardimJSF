<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gebze Belediyesi Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-sticky text-white">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <h:form>
                            <a class="nav-link active text-white" href="#">
                                <h:commandLink action="#{userBean.giris}">
                                    <img src="Assets/GebzeLogo.png" alt="Gebze Belediyesi Logo" class="img-fluid" />
                                </h:commandLink>
                            </a>
                        </h:form>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link main-menu text-white font-weight-bold" href="#">
                            İşlemlerim
                        </a>
                        <ul class="submenu">
                            <li>
                                <a href="#" class="text-white font-weight-bold">Müracaat</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="Muracaat/GenelTakip.xhtml">Genel Takip</a></li>
                                    <li><a href="#" data-page="Muracaat/YeniMuracaat.xhtml">Müracaat Giriş</a></li>
                                    <li><a href="#" data-page="Muracaat/MuracaatListesi.xhtml">Müracaat Listesi</a></li>
                                    <li><a href="#" data-page="Muracaat/EgitimListesi.xhtml">Eğitim Listesi</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="text-white font-weight-bold">Tutanak</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="E.xhtml">Tutanak Giriş</a></li>
                                    <li><a href="#" data-page="F.xhtml">Tutanak Listesi</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="text-white font-weight-bold">Yardım Kararı</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="G.xhtml">Yardım Kararı Listesi</a></li>
                                    <li><a href="#" data-page="H.xhtml">Yardım Karar Özel</a></li>
                                    <li><a href="#" data-page="I.xhtml">Toplu Yardım Yükleme</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="text-white font-weight-bold">Aşevi</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="J.xhtml">Aşevi Bilgisi Girişi</a></li>
                                    <li><a href="#" data-page="K.xhtml">Aşevi Bilgisi Listesi</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="text-white font-weight-bold">Engelli Bilgisi</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="L.xhtml">Engelli Bilgisi Listesi</a></li>
                                    <li><a href="#" data-page="M.xhtml">Engelli Araç Bilgisi Listesi</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="text-white font-weight-bold">Aile Yakınlık Bilgisi</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="N.xhtml">Aile Yakınlık Bilgisi Listesi</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="text-white font-weight-bold">Stok</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="O.xhtml">Stok Girişi</a></li>
                                    <li><a href="#" data-page="P.xhtml">Stok Listesi</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white font-weight-bold" href="#" data-page="raporlar">
                            Raporlar
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link main-menu text-white font-weight-bold" href="#">
                            Yönetici İşlemleri
                        </a>
                        <ul class="submenu">
                            <li>
                                <a href="#" class="text-white font-weight-bold">Kullanıcı</a>
                                <ul class="submenu">
                                    <li><a href="#" data-page="Kullanici/kullanici_girisi.xhtml">Kullanıcı Girişi</a></li>
                                    <li><a href="#" data-page="Kullanici/kullanici_listesi.xhtml">Kullanıcı Listesi</a></li>
                                    <li><a href="#" data-page="Adres/MahalleGiris.xhtml">Mahalle Listesi</a></li>
                                    <li><a href="#" data-page="Adres/CaddeSokakGirisi.xhtml">Cadde/Sokak Listesi</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item mt-2 text-center">
                        <h:form styleClass="text-center">
                            <h:commandButton value="Çıkış" action="#{userBean.cikis}" class="btn btn-danger btn-block small-button"/>
                        </h:form>
                    </li>
                </ul>
            </div>
        </nav>
        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-10">
            <div id="content" class="pt-3 pb-2 mb-3">
                <!-- İçerik burada yüklenecek -->
            </div>
        </main>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
  $(document).ready(function () {
    function loadPage(page) {
        var fullUrl = page;

        $.ajax({
            url: fullUrl,
            dataType: "html",
            success: function (response) {
                $('#content').html(response);
                reapplyStylesAndHandlers();
                reinitializeJSFComponents(); // JSF bileşenlerini yeniden başlatın
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error("Error loading page:", textStatus, errorThrown);
                console.error("Response:", jqXHR.responseText);
                $('#content').html('<p>Sayfa yüklenemedi. Hata: ' + errorThrown + '</p>');
            }
        });
    }

    function reapplyStylesAndHandlers() {
        $('#content .nav-link').removeClass('text-dark').addClass('text-white');
        $('#content .submenu a').removeClass('text-dark').addClass('text-white');
    }

    function reinitializeJSFComponents() {
        if (typeof jsf !== 'undefined') {
            jsf.ajax.request(null, null, { execute: '@all', render: '@all' });
        }
    }

    function handleSubMenuClick(e) {
        e.preventDefault();
        var page = $(this).data('page');
        if (page) {
            loadPage(page);
        } else {
            var submenu = $(this).next('.submenu');
            if (submenu.is(':visible')) {
                submenu.hide();
            } else {
                $(this).parent().siblings().find('.submenu').hide();
                submenu.show();
            }
        }
    }

    $('.main-menu').click(function (e) {
        e.preventDefault();
        var submenu = $(this).next('.submenu');
        if (submenu.is(':visible')) {
            submenu.hide();
        } else {
            $('.submenu').hide();
            submenu.show();
        }
    });

    $('.submenu a').click(handleSubMenuClick);
});

</script>
</body>
</html>