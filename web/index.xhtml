<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Gebze Belediyesi Dashboard</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
        <link rel="stylesheet" href="styles.css" />
        <style>
            .navbar-nav .nav-link { /* navbar menü yazı stili */
                color: #f2f2f2;
            }

            .navbar-nav .nav-link:hover {
                background-color: #575757;
                color: #fff;
            }

            .dropdown-menu {
                background-color: #333;
            }

            .dropdown-menu .dropdown-item {
                color: #f2f2f2;
            }

            .dropdown-menu .dropdown-item:hover {
                background-color: #575757;
            }

            .dropdown-submenu {
                position: relative;
            }

            .dropdown-submenu .dropdown-menu {
                display: none;
                position: absolute;
                left: 100%;
                top: 0;
                background-color: #444;
                min-width: 160px;
            }

            .dropdown-submenu:hover .dropdown-menu {
                display: block;
            }

            .dropdown-item .dropdown-toggle::after {
                display: none; /* Ok simgelerini gizler, gerekirse kaldırabilirsiniz */
            }
            .img-fluid{
                max-height: 60px;
                margin-right: 25px;
            }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg" style="background-color: #08215c;">
            <a class="navbar-brand" href="#">
                <h:form>
                    <h:commandLink action="index.xhtml">
                        <img src="Assets/GebzeLogo123.jpeg" alt="Gebze Belediyesi Logo" class="img-fluid"/>
                    </h:commandLink>
                </h:form>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleDemo01">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarToggleDemo01">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li class="nav-item dropdown">

                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
                           aria-haspopup="true" aria-expanded="false"> İşlemlerim </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item dropdown-toggle" href="#">Müracaat</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Muracaat/GenelTakip.xhtml">Genel Takip</a>
                                <a class="dropdown-item" href="#" data-page="Muracaat/YeniMuracaat.xhtml">Müracaat Giriş</a>
                                <a class="dropdown-item" href="#" data-page="Muracaat/MuracaatListesi.xhtml">Müracaat Listesi</a>
                                <a class="dropdown-item" href="#" data-page="Muracaat/EgitimListesi.xhtml">Eğitim Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Tutanak</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="E.xhtml">Tutanak Giriş</a>
                                <a class="dropdown-item" href="#" data-page="F.xhtml">Tutanak Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Yardım Kararı</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="G.xhtml">Yardım Kararı Listesi</a>
                                <a class="dropdown-item" href="#" data-page="H.xhtml">Yardım Karar Özel</a>
                                <a class="dropdown-item" href="#" data-page="I.xhtml">Toplu Yardım Yükleme</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Aşevi</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="J.xhtml">Aşevi Bilgisi Girişi</a>
                                <a class="dropdown-item" href="#" data-page="K.xhtml">Aşevi Bilgisi Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Engelli Bilgisi</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="L.xhtml">Engelli Bilgisi Listesi</a>
                                <a class="dropdown-item" href="#" data-page="M.xhtml">Engelli Araç Bilgisi Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Aile Yakınlık Bilgisi</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="N.xhtml">Aile Yakınlık Bilgisi Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Stok</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="O.xhtml">Stok Girişi</a>
                                <a class="dropdown-item" href="#" data-page="P.xhtml">Stok Listesi</a>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Raporlar
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown2">
                            <a class="dropdown-item" href="#" data-page="Raporlar/MuracaatRaporu.xhtml">Müracaat Raporu</a>
                            <a class="dropdown-item" href="#" data-page="Raporlar/TutanakRaporu.xhtml">Tutanak Raporu</a>
                            <a class="dropdown-item" href="#" data-page="Raporlar/YardimKararRaporu.xhtml">Yardım Karar Raporu</a>
                            <a class="dropdown-item" href="#" data-page="Raporlar/YardimKararYillikRaporu.xhtml">Yardım Karar Yıllık Raporu</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown3" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Yönetici İşlemleri
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown3">
                            <a class="dropdown-item dropdown-toggle" href="#">Kullanıcı</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Kullanici/kullanici_girisi.xhtml">Kullanıcı Girişi</a>
                                <a class="dropdown-item" href="#" data-page="Kullanici/kullanici_listesi.xhtml">Kullanıcı Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Mahalle</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Adres/MahalleGiris.xhtml">Mahalle Girisi</a>
                                <a class="dropdown-item" href="#" data-page="Adres/MahalleListesi.xhtml">Mahalle Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Cadde/Sokak</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Adres/CaddeSokakGirisi.xhtml">Cadde/Sokak Girisi</a>
                                <a class="dropdown-item" href="#" data-page="Adres/CaddeSokakListesi.xhtml">Cadde/Sokak Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Eğitim</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Egitim/OkulGirisi.xhtml">Okul Girisi</a>
                                <a class="dropdown-item" href="#" data-page="Egitim/OkulListesi.xhtml">Okul Listesi</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Diğer Tanımlar</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Diger/CekmeceTanimlama.xhtml">Çekmece Tanımlama</a>
                                <a class="dropdown-item" href="#" data-page="Diger/MeslekTanimlama.xhtml">Meslek Tanımlama</a>
                                <a class="dropdown-item" href="#" data-page="Diger/YakinlikTanimlama.xhtml">Yakınlık Tanımlama</a>
                                <a class="dropdown-item" href="#" data-page="Diger/TutanakTanimlama.xhtml">Tutanak Durum Tanımlama</a>
                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Yardım Parametreleri</a>
                            <div class="dropdown-submenu">

                                <a class="dropdown-item" href="#" data-page="Yardim/YardimTipi.xhtml">Yardım Tipi Tanımlama</a>
                                <a class="dropdown-item" href="#" data-page="Yardim/YardimAltTipi.xhtml">Yardım Alt Tipi Tanımlama</a>
                                <a class="dropdown-item" href="#" data-page="Yardim/TalepYardimAltTipi.xhtml">Talep Yardım Tipi Tanımlama</a>

                            </div>
                            <a class="dropdown-item dropdown-toggle" href="#">Engelli Tipleri Girişi</a>
                            <div class="dropdown-submenu">
                                <a class="dropdown-item" href="#" data-page="Engelli/EngelliTipi.xhtml">Engelli Tipi Girisi</a>
                                <a class="dropdown-item" href="#" data-page="Engelli/EngelliAltTipi.xhtml">Engelli Alt Tipi Listesi</a>
                                <a class="dropdown-item" href="#" data-page="Engelli/YonlendirilenKurum.xhtml">Yönlendirilen Kurum</a>
                                <a class="dropdown-item" href="#" data-page="Engelli/YonlendirilenAltKurum.xhtml">Yönlendirilen Alt Kurum</a>
                            </div>
                        </div>
                    </li>
                </ul>
                <h:form>
                    <h:commandButton value="Çıkış" action="#{userBean.cikis}" class="btn btn-danger" />
                </h:form>
            </div>
        </nav> 
        <main role="main" class="container-fluid">
            <div id="content">
                <div class="welcome-container">
                    <div class="welcome-message">
                        Hoş Geldiniz!
                    </div>
                </div>
                <!-- İçerik burada yüklenecek -->
            </div>
      </main>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

        <script>
            $(document).ready(function () {
                function loadPage(page) {
                    var fullUrl = page;

                    $.ajax({
                        url: fullUrl,
                        dataType: "html",
                        success: function (response) {
                            $('#content').html(response);
                            reapplyStylesAndHandlers();
                            reinitializeJSFComponents();
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            console.error("Error loading page:", textStatus, errorThrown);
                            console.error("Response:", jqXHR.responseText);
                            $('#content').html('<p>Sayfa yüklenemedi. Hata: ' + errorThrown + '</p>');
                        }
                    });
                }

                function reapplyStylesAndHandlers() {
                    $('#content').find('.nav-link').removeClass('text-dark').addClass('text-white');
                    $('#content').find('.submenu a').removeClass('text-dark').addClass('text-white');

                    $('#content').css({
                        'background-color': '#f8f9fa'
                    });
                }

                function reinitializeJSFComponents() {
                    if (typeof jsf !== 'undefined') {
                        jsf.ajax.request(null, null, {execute: '@all', render: '@all'});
                    }
                }

                // Handle dropdown item clicks to load pages
                $('.dropdown-item').click(function (e) {
                    e.preventDefault();
                    var page = $(this).data('page');
                    if (page) {
                        loadPage(page);
                    }
                });

                // Handle dropdown menu toggles
                $('.dropdown-toggle').click(function (e) {
                    var $el = $(this).next('.dropdown-menu');
                    if ($el.length) {
                        e.preventDefault();
                        var isVisible = $el.is(':visible');
                        $('.dropdown-menu').hide(); // Hide all dropdown menus
                        if (!isVisible) {
                            $el.show(); // Show the clicked dropdown menu
                        }
                    }
                });

                // Handle submenus for non-hover devices
                $('.dropdown-submenu > a').click(function (e) {
                    var $submenu = $(this).next('.dropdown-menu');
                    if ($submenu.length) {
                        e.preventDefault();
                        var isVisible = $submenu.is(':visible');
                        $('.dropdown-submenu .dropdown-menu').not($submenu).hide(); // Hide other submenus
                        if (!isVisible) {
                            $submenu.show(); // Show the clicked submenu
                        } else {
                            $submenu.hide(); // Hide if it's already visible
                        }
                    }
                });

                // Close dropdowns when clicking outside
                $(document).click(function (e) {
                    if (!$(e.target).closest('.dropdown-menu, .dropdown-toggle').length) {
                        $('.dropdown-menu').hide();
                    }
                });
            });

        </script>
    </body>
</html>
